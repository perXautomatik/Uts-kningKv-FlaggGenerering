declare @personNr table (
  x bigint ,
  persorg as (substring(convert(varchar,x),0,len(''+x)-3) + '-' + substring(convert(varchar,x),len(''+x)-3,len(''+x))) persisted not null primary key
)
INSERT INTO @personNr(x) VALUES
(192309033229),(192410283218),(192502215920),(192712248984),(193008123238),(193012163204),(193201163239),(193205153228),(193212273225),(193301119313),(193401223221),(193604123202),(193605163256),(193605283278),(193606183337),(193610243234),(193611103254),(193611223227),(193612113211),(193704203201),(193712033236),(193802163232),(193803263239),(193804083214),(193809032935),(193811273212),(193901173223),(193904033226),(193907288041),(193908183225),(193909083275),(193909173233),(193910063233),(194002293209),(194003260892),(194007233218),(194008183222),(194102233238),(194103103216),(194207113210),(194208031643),(194208073231),(194209219148),(194210153252),(194210203206),(194211193216),(194302053212),(194302133220),(194303208799),(194305017875),(194306063217),(194308103219),(194308293200),(194312113220),(194406233231),(194406233249),(194408203208),(194412192934),(194502103213),(194504013220),(194504253263),(194504273212),(194507013201),(194508193218),(194511133201),(194512233232),(194512250038),(194601140173),(194601303243),(194602053235),(194604133209),(194607221696),(194608143212),(194608283224),(194609073210),(194703026916),(194703243214),(194703300394),(194704173220),(194706063205),(194706163203),(194707100501),(194707163673),(194710233216),(194801123235),(194801313232),(194803033200),(194803153214),(194806243210),(194807253226),(194809083217),(194811253212),(194901179343),(194901303257),(194903030247),(194903053231),(194906273232),(194909123228),(194909183214),(194911053231),(194911083246),(194911253211),(194911271999),(195003223236),(195006163256),(195007056756),(195007233215),(195009107110),(195009210153),(195009220160),(195009303214),(195011073219),(195107102682),(195107193236),(195201263216),(195202173240),(195206031147),(195207231605),(195208063247),(195209041440),(195212033210),(195305046087),(195306023218),(195306213215),(195309283249),(195310193213),(195311043235),(195404233255),(195405010041),(195406123272),(195407113231),(195409113205),(195411119315),(195412242959),(195503031105),(195504011601),(195505313220),(195507069341),(195507103215),(195507303237),(195510133217),(195511104019),(195511113218),(195511233271),(195601202996),(195602151978),(195608090139),(195608211222),(195611213215),(195611253229),(195703040245),(195704013217),(195704253201),(195712083210),(195712212678),(195802049303),(195802140052),(195802263201),(195803053221),(195804073244),(195806127931),(195807113203),(195808091630),(195809151086),(195811123206),(195901193200),(195904013223),(195904050100),(195907163215),(195909108572),(196002123203),(196002151170),(196004163207),(196004263205),(196005276628),(196006203233),(196006263203),(196008043215),(196008253236),(196009075588),(196011053235),(196012293228),(196103133218),(196103275506),(196104119497),(196104123200),(196104213233),(196104233215),(196106131177),(196109233210),(196109253218),(196202181118),(196203063216),(196203083206),(196206143387),(196207023232),(196207173227),(196207281061),(196209163218),(196212041617),(196304033225),(196304220277),(196304233213),(196305093210),(196305220151),(196306097210),(196307143211),(196310103210),(196312123216),(196402233255),(196403163212),(196403163238),(196405133213),(196408253273),(196409161657),(196412293208),(196502081679),(196502090118),(196503071109),(196503133248),(196505074838),(196505078672),(196507181342),(196508041974),(196510233213),(196511023217),(196601030031),(196601033217),(196601241612),(196601306654),(196603023232),(196604053279),(196604260072),(196605273223),(196605283248),(196606103213),(196606293220),(196607303200),(196608163017),(196610071141),(196611101483),(196611223238),(196701253210),(196703271970),(196704073235),(196705101498),(196705193214),(196710263226),(196711303245),(196712313219),(196801070258),(196804133210),(196804248919),(196810229309),(196811273231),(196901220076),(196902131959),(196903213236),(196905020365),(196905036668),(196906163214),(196909240357),(196910233227),(196911070917),(196912123210),(196912233209),(196912310023),(197004243239),(197005173203),(197006013226),(197006123215),(197008053212),(197011140071),(197012043217),(197012300153),(197104150276),(197109112958),(197109273255),(197110053217),(197110210056),(197111133216),(197112113217),(197201033219),(197201093213),(197201240608),(197202023219),(197207030169),(197207183240),(197208040464),(197301053216),(197302233239),(197303133214),(197304145514),(197304203214),(197307063235),(197307104039),(197309063217),(197401083212),(197403094936),(197404280336),(197407153217),(197411133213),(197501163211),(197505083217),(197506260772),(197506303259),(197509073222),(197510293215),(197601293223),(197602103207),(197603213229),(197603227179),(197603283214),(197604223201),(197607193203),(197608190018),(197608290123),(197609113233),(197610087517),(197610101615),(197611296208),(197701193216),(197703170543),(197705203987),(197705233216),(197705243231),(197707251604),(197709237692),(197804083223),(197806223207),(197806300260),(197901083217),(197903123227),(197908093219),(197909073202),(197909080496),(198003213223),(198009043236),(198009050272),(198101053216),(198102243238),(198103023225),(198107213236),(198110063214),(198110163212),(198201210260),(198204083219),(198205183232),(198205234159),(198208233232),(198301143296),(198303233210),(198309203209),(198401078525),(198403163259),(198405033211),(198408193202),(198409283218),(198602142971),(198606063256),(198610250238),(198702237127),(198703173214),(198703313208),(198703315658),(198704233256),(198901053200),(198903312976),(198905100924),(198905173202),(198905223247),(199012171816),(199211020814),(199307062456),(199409302511),(2520041324),(5560210055),(5560748765),(5561883892),(5562838010),(5563023307),(5563243582),(5565657557),(5568510720),(5569656092),(7164049665),(7340000624),(7340002075),(7340003123),(7340003321),(8340004608),(8340013252),(8340020547),(9164249634),(9164254238);;

declare @TimeTable table (x bigint, id char)
DECLARE @start_time DATETIME, @end_time DATETIME SET @start_time = CURRENT_TIMESTAMP

declare @a table (fnr bigint,PERSORGNR bigint);	insert into @a SELECT t.FNR, x PERSORGNR FROM sde_geofir_gotland.gng.FA_TAXERINGAGARE t inner join @personNr pp on  t.PERSORGNR = pp.persorg

SET @end_time = CURRENT_TIMESTAMP insert into @TimeTable SELECT DATEDIFF(ms, @start_time, @end_time),'a'

SET @start_time = CURRENT_TIMESTAMP

declare @b table (fnr bigint,PERSORGNR bigint); insert into @b SELECT t.FNR, x FROM sde_geofir_gotland.gng.FA_TAXERINGAGARE_v2 t inner join @personNr pp on  t.PERSORGNR = pp.persorg

SET @end_time = CURRENT_TIMESTAMP insert into @TimeTable SELECT DATEDIFF(ms, @start_time, @end_time),'b'

SET @start_time = CURRENT_TIMESTAMP

declare @d table (fnr bigint,PERSORGNR bigint); insert into @d SELECT y.FNR, x FROM sde_geofir_gotland.gng.FA_TAXERINGAGARE y inner join @personNr pp on  y.PERSORGNR = pp.persorg

SET @end_time = CURRENT_TIMESTAMP
    insert into @TimeTable
	SELECT DATEDIFF(ms, @start_time, @end_time),'d'

SET @start_time = CURRENT_TIMESTAMP

declare @e table (fnr bigint,PERSORGNR bigint); insert into @e SELECT q.FASTIGHETSNYCKEL, x FROM sde_geofir_gotland.gng.Fastighetsägare q inner join @personNr pp on  q.PERSONORGANISATIONNR = pp.persorg

SET @end_time = CURRENT_TIMESTAMP
    insert into @TimeTable
	SELECT DATEDIFF(ms, @start_time, @end_time),'e'

SET @start_time = CURRENT_TIMESTAMP

declare @i table (fnr bigint,PERSORGNR bigint); insert into @i SELECT q.FNR, x FROM sde_geofir_gotland.gng.FA_TAXERINGAGARE q inner join @personNr pp on  q.PERSORGNR = pp.persorg

SET @end_time = CURRENT_TIMESTAMP
    insert into @TimeTable
	SELECT DATEDIFF(ms, @start_time, @end_time),'i'

--SET @start_time = CURRENT_TIMESTAMP
--declare @j table (fnr bigint,PERSORGNR bigint); insert into @j SELECT q.RealEstateKey, x FROM sde_geofir_gotland.gng.info_OwnerShipChange q inner join @personNr pp on  q.IdNumber = pp.persorg SET @end_time = CURRENT_TIMESTAMP insert into @TimeTable SELECT DATEDIFF(ms, @start_time, @end_time),'j'

--select * from @TimeTable
--		 declare @f table (fnr bigint,PERSORGNR bigint); insert into @f SELECT q.FNR, x FROM sde_geofir_gotland.gng.FA_LAGFART q inner join @personNr pp on  q.PERSORGNR = pp.persorg
--select * from @f


--		declare @g table (fnr bigint,PERSORGNR bigint); insert into @g SELECT q.FNR, x FROM sde_geofir_gotland.gng.FA_LAGFART_V2 q inner join @personNr pp on  q.PERSORGNR = pp.persorg

--select * from @g

--		declare @h table (fnr bigint,PERSORGNR bigint);	insert into @h SELECT q.FNR, x FROM sde_geofir_gotland.gng.FA_TAXERINGAGARE_V2 q inner join @personNr pp on  q.PERSORGNR = pp.persorg
--select * from @h



;drop table #x
    create table #x  (
                      fnr bigint ,
                      PERSORGNR bigint,
		constraint table_name_column_1_column_2_pkxz
			 primary key nonclustered (fnr, PERSORGNR)
			      WITH (IGNORE_DUP_KEY = ON)
    );

	insert into #x
		select * from @a
	insert into #x
		select * from @b
	insert into #x
		select * from @d
	insert into #x
		select * from @e
	--insert into #x select * from @f
	--insert into #x select * from @g
	--insert into #x select * from @h
	insert into #x
		select * from @i
	--insert into #x
--		select * from @j

--select * from #x

select PERSORGNR,ff.fnr,BETECKNING from #x q
    	    inner join
     sde_geofir_gotland.gng.FA_FASTIGHET ff
	on q.FNR = ff.FNR
